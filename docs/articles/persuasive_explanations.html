<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bncounterfactuals">
<title>Get a persuasive explanation of the output of a classifier • bncounterfactuals</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get a persuasive explanation of the output of a classifier">
<meta property="og:description" content="bncounterfactuals">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bncounterfactuals</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/persuasive_explanations.html">Get a persuasive explanation of the output of a classifier</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get a persuasive explanation of the output of a classifier</h1>
            
      
      
      <div class="d-none name"><code>persuasive_explanations.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bncounterfactuals</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.bnlearn.com/" class="external-link">bnlearn</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="persuasive-explanations">Persuasive Explanations<a class="anchor" aria-label="anchor" href="#persuasive-explanations"></a>
</h2>
<p>Persuasive explanations of a classifier output given an input <span class="math inline">\(X\)</span> are a tuple <span class="math inline">\(&lt;S,C&gt;\)</span>, where <span class="math inline">\(S\)</span> is a set of <strong>sufficient
explanations</strong> and <span class="math inline">\(C\)</span> is a
set of <strong>counterfactual</strong> explanations. <strong>Sufficient
explanations</strong> are subsets of the explanatory variables such
that, if they have the same values as in the original input <span class="math inline">\(X\)</span>, the output of the classifier will
remain the same regardless of the value of the rest of the variables.
<strong>Counterfactual explanations</strong> are the opposite: value
assignations to a subset of the explanatory variables such that, if they
all have different values from the original assignation in <span class="math inline">\(X\)</span>, and the other variables remain with
the same value, the output changes.</p>
<div class="section level3">
<h3 id="bfs_sfx">BFS_SFX<a class="anchor" aria-label="anchor" href="#bfs_sfx"></a>
</h3>
<p>BFS_SFX <span class="citation">(Koopman and Renooij 2021)</span> is
an algorithm to find <strong>sufficient explanations</strong> for the
output of a Bayesian Network, but may also be used for almost any
classifier. Below is a use example, where one sufficient explanation is
obtained for the output “<strong>Fallot</strong>”: with
<strong>XrayReport</strong> = “Oligaemic”, it is enough to get the same
output: “<strong>Fallot</strong>”. Note that given the use of an
approximate inference algorithm with few available variables, this
explanation may change due to the inherent randomness of the
algorithm.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://www.bnlearn.com/bnrepository/child/child.rda"</span>,
              <span class="st">"child.rda"</span>, <span class="st">"auto"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"child.rda"</span><span class="op">)</span>  <span class="co"># Load CHILD Bayesian Network</span>
<span class="va">evidence</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  LVHReport<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"yes"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">bn</span><span class="op">$</span><span class="va">LVHreport</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
  LowerBodyO2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"5-12"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">bn</span><span class="op">$</span><span class="va">LowerBodyO2</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
  CO2Report<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"&lt;7.5"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">bn</span><span class="op">$</span><span class="va">CO2Report</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
  XrayReport<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Oligaemic"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">bn</span><span class="op">$</span><span class="va">XrayReport</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bn</span>, node <span class="op">=</span> <span class="va">bn</span><span class="op">$</span><span class="va">Disease</span><span class="op">$</span><span class="va">node</span>, data <span class="op">=</span> <span class="va">evidence</span>,
                 method <span class="op">=</span> <span class="st">"bayes-lw"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Classification input (see dataframe):"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Classification input (see dataframe):"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evidence</span><span class="op">)</span>
<span class="co">#&gt;   LVHReport LowerBodyO2 CO2Report XrayReport</span>
<span class="co">#&gt; 1       yes        5-12      &lt;7.5  Oligaemic</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Classification output:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Classification output:"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">target</span><span class="op">)</span>
<span class="co">#&gt; [1] Fallot</span>
<span class="co">#&gt; Levels: PFC TGA Fallot PAIVS TAPVD Lung</span>
<span class="va">expected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"TGA"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">target</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Expected output was:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Expected output was:"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span>
<span class="co">#&gt; [1] TGA</span>
<span class="co">#&gt; Levels: PFC TGA Fallot PAIVS TAPVD Lung</span>
<span class="va">predict_f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bn</span>, node <span class="op">=</span> <span class="va">bn</span><span class="op">$</span><span class="va">Disease</span><span class="op">$</span><span class="va">node</span>, data <span class="op">=</span> <span class="va">df</span>, method <span class="op">=</span> <span class="st">"bayes-lw"</span>, n <span class="op">=</span> <span class="fl">500000</span><span class="op">)</span><span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Sufficient explanation for the output:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Sufficient explanation for the output:"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/bfs_sfx.html">bfs_sfx</a></span><span class="op">(</span><span class="va">predict_f</span>, <span class="va">evidence</span>, <span class="va">target</span>, <span class="va">expected</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ :List of 1</span>
<span class="co">#&gt;   ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 2</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bfs_cfx">BFS_CFX<a class="anchor" aria-label="anchor" href="#bfs_cfx"></a>
</h3>
<p>BFS_CFX <span class="citation">(Koopman and Renooij 2021)</span> is
an algorithm to find <strong>counterfactual explanations</strong> for
the output of a Bayesian Network, but may also be used for almost any
classifier. It is applied in a similar fashion to BFS_CFX (shown above).
The output for the next example gives possible counterfactual
explanations that would have given the output “TGA” if the rest of the
variables maintain the same values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Classification input (see dataframe):"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Classification input (see dataframe):"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evidence</span><span class="op">)</span>
<span class="co">#&gt;   LVHReport LowerBodyO2 CO2Report XrayReport</span>
<span class="co">#&gt; 1       yes        5-12      &lt;7.5  Oligaemic</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Classification output:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Classification output:"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">target</span><span class="op">)</span>
<span class="co">#&gt; [1] Fallot</span>
<span class="co">#&gt; Levels: PFC TGA Fallot PAIVS TAPVD Lung</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Expected output was:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Expected output was:"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span>
<span class="co">#&gt; [1] TGA</span>
<span class="co">#&gt; Levels: PFC TGA Fallot PAIVS TAPVD Lung</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Counterfactual explanations for the output:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Counterfactual explanations for the output:"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/bfs_cfx.html">bfs_cfx</a></span><span class="op">(</span><span class="va">predict_f</span>, <span class="va">evidence</span>, <span class="va">target</span>, <span class="va">expected</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ :List of 1</span>
<span class="co">#&gt;   ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 1</span>
<span class="co">#&gt;  $ :List of 1</span>
<span class="co">#&gt;   ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 3</span>
<span class="co">#&gt;  $ :List of 1</span>
<span class="co">#&gt;   ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 4</span>
<span class="co">#&gt;  $ :List of 2</span>
<span class="co">#&gt;   ..$ LowerBodyO2: Factor w/ 3 levels "&lt;5","5-12","12+": 1</span>
<span class="co">#&gt;   ..$ XrayReport : Factor w/ 5 levels "Normal","Oligaemic",..: 5</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bfs_sfx_cfx">BFS_SFX_CFX<a class="anchor" aria-label="anchor" href="#bfs_sfx_cfx"></a>
</h3>
<p>BFS_SFX_CFX <span class="citation">(Koopman and Renooij 2021)</span>
is a combination of both algorithms above that computes at the same time
counterfactual and sufficient explanations of an outcome. The different
pairs that can be formed with the sufficient explanations and the
counterfactual explanations are called persuasive explanations. The
algorithm is used similarly to both above:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Classification input (see dataframe):"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Classification input (see dataframe):"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evidence</span><span class="op">)</span>
<span class="co">#&gt;   LVHReport LowerBodyO2 CO2Report XrayReport</span>
<span class="co">#&gt; 1       yes        5-12      &lt;7.5  Oligaemic</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Classification output:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Classification output:"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">target</span><span class="op">)</span>
<span class="co">#&gt; [1] Fallot</span>
<span class="co">#&gt; Levels: PFC TGA Fallot PAIVS TAPVD Lung</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Expected output was:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Expected output was:"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span>
<span class="co">#&gt; [1] TGA</span>
<span class="co">#&gt; Levels: PFC TGA Fallot PAIVS TAPVD Lung</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Persuasive explanations for the output:"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Persuasive explanations for the output:"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/bfs_sfx_cfx.html">bfs_sfx_cfx</a></span><span class="op">(</span><span class="va">predict_f</span>, <span class="va">evidence</span>, <span class="va">target</span>, <span class="va">expected</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ sfxs:List of 1</span>
<span class="co">#&gt;   ..$ :List of 1</span>
<span class="co">#&gt;   .. ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 2</span>
<span class="co">#&gt;  $ cfxs:List of 4</span>
<span class="co">#&gt;   ..$ :List of 1</span>
<span class="co">#&gt;   .. ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 1</span>
<span class="co">#&gt;   ..$ :List of 1</span>
<span class="co">#&gt;   .. ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 3</span>
<span class="co">#&gt;   ..$ :List of 1</span>
<span class="co">#&gt;   .. ..$ XrayReport: Factor w/ 5 levels "Normal","Oligaemic",..: 4</span>
<span class="co">#&gt;   ..$ :List of 2</span>
<span class="co">#&gt;   .. ..$ LowerBodyO2: Factor w/ 3 levels "&lt;5","5-12","12+": 1</span>
<span class="co">#&gt;   .. ..$ XrayReport : Factor w/ 5 levels "Normal","Oligaemic",..: 5</span></code></pre></div>
<div class="section level4">
<h4 id="using-a-helper-function-for-bnlearn">Using a helper function for bnlearn<a class="anchor" aria-label="anchor" href="#using-a-helper-function-for-bnlearn"></a>
</h4>
<p>A wrapper function is provided to use this algorithm with a Bayesian
Network as implemented in bnlearn <span class="citation">(Scutari,
Silander, and Ness 2021)</span>. The main advantage is that it allows to
set a threshold for classification of the MLE. Currently setting a
threshold for each label is not allowed, and it is planned to make a
change to include this feature soon, as it is a limited policy.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Predict most likely label if posterior prob &gt; 0.20 else predict TGA</span>
<span class="va">predict_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bnlearn_predict_wrapper.html">bnlearn_predict_wrapper</a></span><span class="op">(</span><span class="va">bn</span>, <span class="va">bn</span><span class="op">$</span><span class="va">Disease</span><span class="op">$</span><span class="va">node</span>, <span class="st">"bayes-lw"</span>,
                                     threshold<span class="op">=</span><span class="fl">0.20</span>, default<span class="op">=</span><span class="st">"TGA"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/bfs_sfx.html">bfs_sfx</a></span><span class="op">(</span><span class="va">predict_f</span>, <span class="va">evidence</span>, <span class="va">target</span>, <span class="va">expected</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]]$CO2Report</span>
<span class="co">#&gt; [1] &lt;7.5</span>
<span class="co">#&gt; Levels: &lt;7.5 &gt;=7.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]]$XrayReport</span>
<span class="co">#&gt; [1] Oligaemic</span>
<span class="co">#&gt; Levels: Normal Oligaemic Plethoric Grd_Glass Asy/Patchy</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [[2]]$LVHReport</span>
<span class="co">#&gt; [1] yes</span>
<span class="co">#&gt; Levels: yes no</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]$XrayReport</span>
<span class="co">#&gt; [1] Oligaemic</span>
<span class="co">#&gt; Levels: Normal Oligaemic Plethoric Grd_Glass Asy/Patchy</span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-koopman2021persuasive" class="csl-entry">
Koopman, Tara, and Silja Renooij. 2021. <span>“Persuasive Contrastive
Explanations for Bayesian Networks.”</span> In <em>European Conference
on Symbolic and Quantitative Approaches with Uncertainty</em>, 229–42.
Springer.
</div>
<div id="ref-R-bnlearn" class="csl-entry">
Scutari, Marco, Tomi Silander, and Robert Ness. 2021. <em>Bnlearn:
Bayesian Network Structure Learning, Parameter Learning and
Inference</em>. <a href="https://www.bnlearn.com/" class="external-link">https://www.bnlearn.com/</a>.
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by johacks.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
